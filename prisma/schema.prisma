generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Department {
  id           String       @id @default(cuid())
  name         String
  imageUrl     String       @map("image_url")
  displayOrder Int          @map("display_order")
  createdAt    DateTime     @default(now()) @map("created_at")
  updatedAt    DateTime     @updatedAt @map("updated_at")
  evaluations  Evaluation[]

  @@map("departments")
}

model EvaluationCriteria {
  id           String       @id @default(cuid())
  name         String
  displayOrder Int          @map("display_order")
  isActive     Boolean      @default(true) @map("is_active")
  createdAt    DateTime     @default(now()) @map("created_at")
  updatedAt    DateTime     @updatedAt @map("updated_at")
  evaluations  Evaluation[]

  @@map("evaluation_criteria")
}

model Evaluation {
  id           String             @id @default(cuid())
  departmentId String             @map("department_id")
  criteriaId   String             @map("criteria_id")
  fingerprint  String
  eventYear    Int                @map("event_year")
  score        Int
  createdAt    DateTime           @default(now()) @map("created_at")
  criteria     EvaluationCriteria @relation(fields: [criteriaId], references: [id])
  department   Department         @relation(fields: [departmentId], references: [id])

  @@unique([fingerprint, eventYear, departmentId, criteriaId])
  @@map("evaluations")
}

model EventConfig {
  id               String   @id @default(cuid())
  year             Int      @unique
  targetEvaluators Int      @default(100) @map("target_evaluators")
  isActive         Boolean  @default(true) @map("is_active")
  createdAt        DateTime @default(now()) @map("created_at")
  updatedAt        DateTime @updatedAt @map("updated_at")

  @@map("event_configs")
}
